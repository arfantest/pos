<div class="expense-form-container">
  <nz-breadcrumb>
    <nz-breadcrumb-item>
      <i nz-icon nzType="home"></i>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a routerLink="/expenses">Expenses</a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>{{ isEditMode ? 'Edit Expense' : 'New Expense' }}</nz-breadcrumb-item>
  </nz-breadcrumb>

  <div class="page-header">
    <h2>{{ isEditMode ? 'Edit Expense' : 'Add New Expense' }}</h2>
  </div>

  <nz-card [nzLoading]="loading">
    <form nz-form [formGroup]="expenseForm" (ngSubmit)="onSubmit()">
      <div nz-row [nzGutter]="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="description">Description</nz-form-label>
            <nz-form-control [nzSm]="18" [nzXs]="24" nzErrorTip="Please enter expense description (minimum 3 characters)">
              <input nz-input formControlName="description" id="description" placeholder="e.g., Office rent payment" />
            </nz-form-control>
          </nz-form-item>
        </div>
        
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="amount">Amount</nz-form-label>
            <nz-form-control [nzSm]="18" [nzXs]="24" nzErrorTip="Please enter a valid amount">
              <nz-input-number 
                formControlName="amount" 
                id="amount" 
                [nzMin]="0.01" 
                [nzStep]="0.01" 
                nzPlaceHolder="0.00"
                style="width: 100%">
              </nz-input-number>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <div nz-row [nzGutter]="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="date">Date</nz-form-label>
            <nz-form-control [nzSm]="18" [nzXs]="24" nzErrorTip="Please select date">
              <nz-date-picker formControlName="date" id="date" style="width: 100%"></nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="category">Category</nz-form-label>
            <nz-form-control [nzSm]="18" [nzXs]="24" nzErrorTip="Please select category">
              <nz-select formControlName="category" id="category" nzPlaceHolder="Select category">
                <nz-option *ngFor="let category of expenseCategories" [nzLabel]="category" [nzValue]="category">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <div nz-row [nzGutter]="16">
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="accountId">Account</nz-form-label>
            <nz-form-control [nzSm]="18" [nzXs]="24" nzErrorTip="Please select account">
              <nz-select formControlName="accountId" id="accountId" nzPlaceHolder="Select account">
                <nz-option *ngFor="let account of accounts" [nzLabel]="account.code + ' - ' + account.name" [nzValue]="account.id">
                </nz-option>
              </nz-select>
              <!-- <nz-form-explain>Select the account to debit for this expense</nz-form-explain> -->
            </nz-form-control>
          </nz-form-item>
        </div>
        
        <div nz-col nzXs="24" nzSm="12">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="receiptNumber">Receipt #</nz-form-label>
            <nz-form-control [nzSm]="18" [nzXs]="24">
              <input nz-input formControlName="receiptNumber" id="receiptNumber" placeholder="e.g., RCP-001" />
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <nz-form-item>
        <nz-form-label [nzSm]="3" [nzXs]="24" nzFor="notes">Notes</nz-form-label>
        <nz-form-control [nzSm]="21" [nzXs]="24">
          <textarea nz-input formControlName="notes" id="notes"  
                    placeholder="Additional notes about this expense" rows="3"></textarea>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzSm]="{ span: 21, offset: 3 }" [nzXs]="{ span: 24, offset: 0 }">
          <button nz-button nzType="default" (click)="onCancel()" [disabled]="submitting">
            Cancel
          </button>
          <button nz-button nzType="primary" [nzLoading]="submitting" [disabled]="!expenseForm.valid" 
                  style="margin-left: 8px;">
            {{ isEditMode ? 'Update Expense' : 'Add Expense' }}
          </button>
        </nz-form-control>
      </nz-form-item>
    </form>
  </nz-card>
</div>
